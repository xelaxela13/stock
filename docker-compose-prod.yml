version: '3'

services:
  web:
    container_name: web
    restart: always
    # указываем откуда собирать образ
    build:
      context: .
      dockerfile: docker/web/Dockerfile
    # монтируем директорию проекта
    volumes:
    - .:/srv/www/stock
    expose:
    - 8080
    ports:
    - 8080:8001
    # запускаем gunicorn
    command: "gunicorn -c gunicorn.py project.wsgi"
    depends_on:
    - postgres
    - redis
    - memcached